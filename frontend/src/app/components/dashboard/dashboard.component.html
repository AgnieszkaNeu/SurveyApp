<div class="dashboard-container">
  <div class="container mt-4 pb-5">
    
  <div class="row mb-4">
    <div class="col-12">
        <h1 class="display-5 fw-bold mb-1">Panel główny</h1>
        <p class="text-muted mb-0" *ngIf="user">Witaj, {{ user.email }}! Zarządzaj swoimi ankietami w jednym miejscu.</p>
        <p class="text-muted mb-0" *ngIf="!user">Witaj! Zarządzaj swoimi ankietami w jednym miejscu.</p>
    </div>
  </div>

    <div class="row mb-4 g-4">
      <div class="col-md-4">
        <div class="stat-card stat-card--primary">
          <div class="stat-card-body">
            <div class="stat-card-content">
              <p class="stat-label">Wszystkie ankiety</p>
              <h2 class="stat-value">{{ surveysCount }}</h2>
            </div>
            <div class="stat-icon stat-icon--primary">
              <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14 2 14 8 20 8"/>
              </svg>
          </div>
        </div>
      </div>
    </div>

      <div class="col-md-4">
        <div class="stat-card stat-card--success">
          <div class="stat-card-body">
            <div class="stat-card-content">
              <p class="stat-label">Publiczne</p>
              <h2 class="stat-value">{{ publicSurveysCount }}</h2>
            </div>
            <div class="stat-icon stat-icon--success">
              <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
              </svg>
          </div>
        </div>
      </div>
    </div>

      <div class="col-md-4">
        <div class="stat-card stat-card--warning">
          <div class="stat-card-body">
            <div class="stat-card-content">
              <p class="stat-label">Prywatne</p>
              <h2 class="stat-value">{{ privateSurveysCount }}</h2>
            </div>
            <div class="stat-icon stat-icon--warning">
              <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
              </svg>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row mb-4">
    <div class="col-12">
        <div class="quick-actions-card">
          <div class="quick-actions-body">
            <div class="quick-actions-header mb-3">
              <h5 class="quick-actions-title mb-1">Szybkie akcje</h5>
              <p class="quick-actions-subtitle mb-0">Rozpocznij pracę z ankietami</p>
            </div>
            <div class="quick-actions-grid">
              <a routerLink="/survey/create" class="btn btn-primary btn-lg d-flex align-items-center justify-content-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
              Utwórz nową ankietę
            </a>
              <a routerLink="/surveys" class="btn btn-outline-primary btn-lg d-flex align-items-center justify-content-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="8" y1="6" x2="21" y2="6"/>
                <line x1="8" y1="12" x2="21" y2="12"/>
                <line x1="8" y1="18" x2="21" y2="18"/>
                <line x1="3" y1="6" x2="3.01" y2="6"/>
                <line x1="3" y1="12" x2="3.01" y2="12"/>
                <line x1="3" y1="18" x2="3.01" y2="18"/>
              </svg>
              Zobacz wszystkie ankiety
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-12">
        <div class="recent-surveys-header mb-3">
          <h5 class="mb-0">Ostatnie ankiety</h5>
        </div>
          
          <div *ngIf="loading" class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>

        <div *ngIf="!loading && surveys.length === 0" class="empty-state-card">
          <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="text-muted mb-3">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
          </svg>
          <h4 class="text-muted mb-2">Nie masz jeszcze żadnych ankiet</h4>
          <p class="text-muted mb-3">Utwórz swoją pierwszą ankietę i zacznij zbierać odpowiedzi</p>
          <a routerLink="/survey/create" class="btn btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-1">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
            Utwórz pierwszą ankietę
          </a>
          </div>

        <div *ngIf="!loading && surveys.length > 0" class="row g-4">
          <div class="col-12 col-lg-6" *ngFor="let survey of surveys.slice(0, 6)">
            <div class="dashboard-survey-card">
              
              <div class="dashboard-survey-card-header">
                <div class="d-flex justify-content-between align-items-center">
                  
                  <span class="status-badge" [ngClass]="{
                    'status-badge--public': survey.status === 'public',
                    'status-badge--private': survey.status === 'private',
                    'status-badge--expired': survey.status === 'expired'
                    }">
                    <span class="status-badge__dot"></span>
                      {{ survey.status === 'public' ? 'Publiczna' : survey.status === 'private' ? 'Prywatna' : 'Wygasła' }}
                    </span>
                  
                  <span *ngIf="survey.is_locked" class="badge bg-danger" title="Edycja zablokowana">
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-1">
                      <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                      <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                    </svg>
                    Zablokowana
                  </span>
                </div>
              </div>
              
              <div class="dashboard-survey-card-body">
                
                <h5 class="dashboard-survey-card-title">
                  <a [routerLink]="['/survey', survey.id]" class="text-decoration-none">
                    {{ survey.name }}
                  </a>
                </h5>
                
                <div class="dashboard-survey-card-metadata">
                  <span class="metadata-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <circle cx="12" cy="12" r="10"/>
                      <polyline points="12 6 12 12 16 14"/>
                    </svg>
                    {{ survey.created_at | date: 'dd MMM yyyy' }}
                    </span>
                </div>
                
                <div class="dashboard-survey-card-metrics">
                  
                  <div class="metric-item metric-item--primary">
                    <div class="metric-value">{{ survey.submission_count }}</div>
                    <div class="metric-label">
                      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                        <circle cx="9" cy="7" r="4"/>
                        <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                      </svg>
                      Odpowiedzi
                    </div>
                  </div>
                  
                  <div class="metric-item">
                    <div class="metric-value">{{ survey.questions?.length || 0 }}</div>
                    <div class="metric-label">
                      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                      </svg>
                      Pytania
                    </div>
                  </div>
                </div>
                
                <div class="dashboard-survey-card-actions">
                  <a [routerLink]="['/survey', survey.id, 'results']" class="btn btn-primary btn-sm flex-fill">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-1">
                      <line x1="18" y1="20" x2="18" y2="10"/>
                      <line x1="12" y1="20" x2="12" y2="4"/>
                      <line x1="6" y1="20" x2="6" y2="14"/>
                    </svg>
                    Wyniki
                  </a>
                  <a [routerLink]="['/survey', survey.id]" class="btn btn-outline-primary btn-sm flex-fill">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-1">
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                      <circle cx="12" cy="12" r="3"/>
                    </svg>
                    Zobacz
                  </a>
                </div>
              </div>
          </div>
          </div>
        </div>

        <div *ngIf="surveys.length > 6" class="text-center mt-4">
          <a routerLink="/surveys" class="btn btn-outline-primary">
            Zobacz wszystkie ({{ surveys.length }})
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
