<div class="template-list-container">
  <div class="container mt-4 pb-5">
    
    <div class="row mb-4">
      <div class="col-12 d-flex justify-content-between align-items-center">
        <div>
          <h1 class="display-6 fw-bold mb-1">Szablony ankiet</h1>
          <p class="text-muted mb-0">Zaoszczędź czas korzystając z gotowych szablonów</p>
        </div>
        <a routerLink="/survey/create" class="btn btn-outline-primary d-flex align-items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
          <span class="d-none d-sm-inline">Utwórz od zera</span>
    </a>
      </div>
  </div>

    <div class="template-tabs mb-4">
      <button 
        class="template-tab" 
        [class.template-tab--active]="activeTab === 'public'" 
        (click)="activeTab = 'public'"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-2">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
          <circle cx="9" cy="7" r="4"/>
          <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
        </svg>
        Publiczne szablony
        <span class="template-tab-badge">{{ publicTemplates.length }}</span>
      </button>
      <button 
        class="template-tab" 
        [class.template-tab--active]="activeTab === 'my'" 
        (click)="activeTab = 'my'"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-2">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
          <circle cx="12" cy="7" r="4"/>
        </svg>
        Moje szablony
        <span class="template-tab-badge">{{ myTemplates.length }}</span>
      </button>
    </div>

  <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show" role="alert">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-2">
        <polyline points="20 6 9 17 4 12"/>
      </svg>
    {{ successMessage }}
    <button type="button" class="btn-close" (click)="successMessage = null" aria-label="Zamknij"></button>
  </div>

  <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-2">
        <circle cx="12" cy="12" r="10"/>
        <line x1="15" y1="9" x2="9" y2="15"/>
        <line x1="9" y1="9" x2="15" y2="15"/>
      </svg>
    {{ error }}
    <button type="button" class="btn-close" (click)="error = null" aria-label="Zamknij"></button>
  </div>

  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Ładowanie...</span>
    </div>
  </div>

  <div *ngIf="!loading && activeTab === 'public'" class="row g-4">
    <div *ngIf="publicTemplates.length === 0" class="col-12">
        <div class="empty-state-card">
          <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="text-muted mb-3">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
        </svg>
          <h4 class="text-muted mb-2">Brak dostępnych publicznych szablonów</h4>
          <p class="text-muted mb-0">Wkrótce pojawią się tutaj gotowe szablony ankiet</p>
      </div>
    </div>
    
    <div *ngFor="let template of publicTemplates" class="col-md-6 col-lg-4">
        <div class="template-card">
          
          <div class="template-card-header">
            <div class="template-icon-wrapper">
              <div class="template-icon" [innerHTML]="getCategoryIcon(template.category)"></div>
            </div>
            <span class="template-badge">{{ getCategoryLabel(template.category) }}</span>
          </div>
          
          <div class="template-card-body">
            <h5 class="template-card-title">{{ template.name }}</h5>
            <p class="template-card-description" *ngIf="template.description">
            {{ template.description }}
          </p>
            <p class="template-card-description text-muted fst-italic" *ngIf="!template.description">
              Brak opisu szablonu
            </p>
          </div>
          
          <div class="template-card-footer">
            <div class="template-usage">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-1">
                <path d="M17 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
              </svg>
              {{ template.usage_count }}× użyto
            </div>
            <button class="btn btn-primary btn-sm" (click)="useTemplate(template)">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-1">
                <polyline points="9 11 12 14 22 4"/>
                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
              </svg>
              Użyj
            </button>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!loading && activeTab === 'my'" class="row g-4">
    <div *ngIf="myTemplates.length === 0" class="col-12">
        <div class="empty-state-card">
          <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="text-muted mb-3">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
          </svg>
          <h4 class="text-muted mb-2">Nie masz jeszcze własnych szablonów</h4>
          <p class="text-muted mb-3">Utwórz ankietę i zapisz ją jako szablon!</p>
          <a routerLink="/survey/create" class="btn btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-1">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
            Utwórz pierwszą ankietę
          </a>
      </div>
    </div>
    
    <div *ngFor="let template of myTemplates" class="col-md-6 col-lg-4">
        <div class="template-card">
          
          <div class="template-card-header">
            <div class="template-icon-wrapper">
              <div class="template-icon" [innerHTML]="getCategoryIcon(template.category)"></div>
            </div>
            <span class="template-badge template-badge--my">{{ getCategoryLabel(template.category) }}</span>
          </div>
          
          <div class="template-card-body">
            <h5 class="template-card-title">{{ template.name }}</h5>
            <p class="template-card-description" *ngIf="template.description">
            {{ template.description }}
          </p>
            <p class="template-card-description text-muted fst-italic" *ngIf="!template.description">
              Brak opisu szablonu
            </p>
          </div>
          
          <div class="template-card-footer">
            <div class="template-usage">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-1">
                <path d="M17 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
              </svg>
              {{ template.usage_count }}× użyto
            </div>
            <div class="template-actions">
              <button class="btn btn-primary btn-sm" (click)="useTemplate(template)">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-1">
                  <polyline points="9 11 12 14 22 4"/>
                  <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
                </svg>
                Użyj
              </button>
              <button class="btn btn-outline-danger btn-sm" (click)="deleteTemplate(template)">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="3 6 5 6 21 6"/>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade show" [class.d-block]="showDeleteModal" *ngIf="showDeleteModal" tabindex="-1" style="background: rgba(0,0,0,0.5);">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-warning me-2" style="display: inline-block; vertical-align: middle;">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
            <line x1="12" y1="9" x2="12" y2="13"></line>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
          Usunąć szablon?
        </h5>
        <button type="button" class="btn-close" (click)="cancelDelete()"></button>
      </div>
      <div class="modal-body">
        <p class="mb-0" *ngIf="templateToDelete">
          Czy na pewno chcesz usunąć szablon <strong>"{{ templateToDelete.name }}"</strong>? Ta operacja jest nieodwracalna.
        </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" (click)="cancelDelete()">Anuluj</button>
        <button type="button" class="btn btn-danger" (click)="confirmDelete()">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-1" style="display: inline-block; vertical-align: middle;">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
          Usuń szablon
        </button>
      </div>
    </div>
  </div>
</div>
